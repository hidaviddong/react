{"version":3,"file":"jest-react.production.js","sources":["../../../../packages/shared/assign.js","../../../../packages/shared/ReactSymbols.js","../../../../packages/shared/isArray.js","../../../../packages/jest-react/src/JestReact.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nconst assign = Object.assign;\n\nexport default assign;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {renameElementSymbol} from 'shared/ReactFeatureFlags';\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types.\nexport const REACT_LEGACY_ELEMENT_TYPE: symbol = Symbol.for('react.element');\nexport const REACT_ELEMENT_TYPE: symbol = renameElementSymbol\n  ? Symbol.for('react.transitional.element')\n  : REACT_LEGACY_ELEMENT_TYPE;\nexport const REACT_PORTAL_TYPE: symbol = Symbol.for('react.portal');\nexport const REACT_FRAGMENT_TYPE: symbol = Symbol.for('react.fragment');\nexport const REACT_STRICT_MODE_TYPE: symbol = Symbol.for('react.strict_mode');\nexport const REACT_PROFILER_TYPE: symbol = Symbol.for('react.profiler');\nexport const REACT_PROVIDER_TYPE: symbol = Symbol.for('react.provider'); // TODO: Delete with enableRenderableContext\nexport const REACT_CONSUMER_TYPE: symbol = Symbol.for('react.consumer');\nexport const REACT_CONTEXT_TYPE: symbol = Symbol.for('react.context');\nexport const REACT_FORWARD_REF_TYPE: symbol = Symbol.for('react.forward_ref');\nexport const REACT_SUSPENSE_TYPE: symbol = Symbol.for('react.suspense');\nexport const REACT_SUSPENSE_LIST_TYPE: symbol = Symbol.for(\n  'react.suspense_list',\n);\nexport const REACT_MEMO_TYPE: symbol = Symbol.for('react.memo');\nexport const REACT_LAZY_TYPE: symbol = Symbol.for('react.lazy');\nexport const REACT_SCOPE_TYPE: symbol = Symbol.for('react.scope');\nexport const REACT_ACTIVITY_TYPE: symbol = Symbol.for('react.activity');\nexport const REACT_LEGACY_HIDDEN_TYPE: symbol = Symbol.for(\n  'react.legacy_hidden',\n);\nexport const REACT_TRACING_MARKER_TYPE: symbol = Symbol.for(\n  'react.tracing_marker',\n);\n\nexport const REACT_MEMO_CACHE_SENTINEL: symbol = Symbol.for(\n  'react.memo_cache_sentinel',\n);\n\nexport const REACT_POSTPONE_TYPE: symbol = Symbol.for('react.postpone');\n\nexport const REACT_VIEW_TRANSITION_TYPE: symbol = Symbol.for(\n  'react.view_transition',\n);\n\nconst MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<any> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n\nexport const ASYNC_ITERATOR = Symbol.asyncIterator;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\ndeclare function isArray(a: mixed): boolean %checks(Array.isArray(a));\n\nconst isArrayImpl = Array.isArray;\n\nfunction isArray(a: mixed): boolean {\n  return isArrayImpl(a);\n}\n\nexport default isArray;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {REACT_ELEMENT_TYPE, REACT_FRAGMENT_TYPE} from 'shared/ReactSymbols';\nconst {assertConsoleLogsCleared} = require('internal-test-utils/consoleMock');\n\nimport isArray from 'shared/isArray';\n\nfunction captureAssertion(fn) {\n  // Trick to use a Jest matcher inside another Jest matcher. `fn` contains an\n  // assertion; if it throws, we capture the error and return it, so the stack\n  // trace presented to the user points to the original assertion in the\n  // test file.\n  try {\n    fn();\n  } catch (error) {\n    return {\n      pass: false,\n      message: () => error.message,\n    };\n  }\n  return {pass: true};\n}\n\nfunction assertYieldsWereCleared(root) {\n  const Scheduler = root._Scheduler;\n  const actualYields = Scheduler.unstable_clearLog();\n  if (actualYields.length !== 0) {\n    const error = Error(\n      'Log of yielded values is not empty. ' +\n        'Call expect(ReactTestRenderer).unstable_toHaveYielded(...) first.',\n    );\n    Error.captureStackTrace(error, assertYieldsWereCleared);\n    throw error;\n  }\n  assertConsoleLogsCleared();\n}\n\nfunction createJSXElementForTestComparison(type, props) {\n  if (__DEV__) {\n    const element = {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: null,\n      props: props,\n      _owner: null,\n      _store: __DEV__ ? {} : undefined,\n    };\n    Object.defineProperty(element, 'ref', {\n      enumerable: false,\n      value: null,\n    });\n    return element;\n  } else {\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: null,\n      ref: null,\n      props: props,\n    };\n  }\n}\n\nexport function unstable_toMatchRenderedOutput(root, expectedJSX) {\n  assertYieldsWereCleared(root);\n  const actualJSON = root.toJSON();\n\n  let actualJSX;\n  if (actualJSON === null || typeof actualJSON === 'string') {\n    actualJSX = actualJSON;\n  } else if (isArray(actualJSON)) {\n    if (actualJSON.length === 0) {\n      actualJSX = null;\n    } else if (actualJSON.length === 1) {\n      actualJSX = jsonChildToJSXChild(actualJSON[0]);\n    } else {\n      const actualJSXChildren = jsonChildrenToJSXChildren(actualJSON);\n      if (actualJSXChildren === null || typeof actualJSXChildren === 'string') {\n        actualJSX = actualJSXChildren;\n      } else {\n        actualJSX = createJSXElementForTestComparison(REACT_FRAGMENT_TYPE, {\n          children: actualJSXChildren,\n        });\n      }\n    }\n  } else {\n    actualJSX = jsonChildToJSXChild(actualJSON);\n  }\n\n  return captureAssertion(() => {\n    expect(actualJSX).toEqual(expectedJSX);\n  });\n}\n\nfunction jsonChildToJSXChild(jsonChild) {\n  if (jsonChild === null || typeof jsonChild === 'string') {\n    return jsonChild;\n  } else {\n    const jsxChildren = jsonChildrenToJSXChildren(jsonChild.children);\n    return createJSXElementForTestComparison(\n      jsonChild.type,\n      jsxChildren === null\n        ? jsonChild.props\n        : {...jsonChild.props, children: jsxChildren},\n    );\n  }\n}\n\nfunction jsonChildrenToJSXChildren(jsonChildren) {\n  if (jsonChildren !== null) {\n    if (jsonChildren.length === 1) {\n      return jsonChildToJSXChild(jsonChildren[0]);\n    } else if (jsonChildren.length > 1) {\n      const jsxChildren = [];\n      let allJSXChildrenAreStrings = true;\n      let jsxChildrenString = '';\n      for (let i = 0; i < jsonChildren.length; i++) {\n        const jsxChild = jsonChildToJSXChild(jsonChildren[i]);\n        jsxChildren.push(jsxChild);\n        if (allJSXChildrenAreStrings) {\n          if (typeof jsxChild === 'string') {\n            jsxChildrenString += jsxChild;\n          } else if (jsxChild !== null) {\n            allJSXChildrenAreStrings = false;\n          }\n        }\n      }\n      return allJSXChildrenAreStrings ? jsxChildrenString : jsxChildren;\n    }\n  }\n  return null;\n}\n"],"names":["assign","Object","REACT_ELEMENT_TYPE","Symbol","for","REACT_FRAGMENT_TYPE","isArrayImpl","Array","isArray","a","_require","require","assertConsoleLogsCleared","captureAssertion","fn","error","pass","message","assertYieldsWereCleared","root","Scheduler","_Scheduler","actualYields","unstable_clearLog","length","Error","captureStackTrace","createJSXElementForTestComparison","type","props","$$typeof","key","ref","unstable_toMatchRenderedOutput","expectedJSX","actualJSON","toJSON","actualJSX","jsonChildToJSXChild","actualJSXChildren","jsonChildrenToJSXChildren","children","expect","toEqual","jsonChild","jsxChildren","_assign","jsonChildren","allJSXChildrenAreStrings","jsxChildrenString","i","jsxChild","push"],"mappings":"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"}